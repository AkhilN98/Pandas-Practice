---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.4.2
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

# United States - Crime Rates - 1960 - 2014


### Introduction:

This time you will create a data 

Special thanks to: https://github.com/justmarkham for sharing the dataset and materials.

### Step 1. Import the necessary libraries

```{python jupyter={'outputs_hidden': False}}
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
sns.set_style('whitegrid')
# %matplotlib inline

# Optional Plotly Method Imports
import plotly
import cufflinks as cf
cf.go_offline()
```

### Step 2. Import the dataset from this [address](https://raw.githubusercontent.com/guipsamora/pandas_exercises/master/04_Apply/US_Crime_Rates/US_Crime_Rates_1960_2014.csv). 

```{python}
url = 'https://raw.githubusercontent.com/guipsamora/pandas_exercises/master/04_Apply/US_Crime_Rates/US_Crime_Rates_1960_2014.csv'
df = pd.read_csv(url)
```

### Step 3. Assign it to a variable called crime.

```{python jupyter={'outputs_hidden': False}}
crime = df
```

### Step 4. What is the type of the columns?

```{python jupyter={'outputs_hidden': False}}
crime.info()
```

##### Have you noticed that the type of Year is int64. But pandas has a different type to work with Time Series. Let's see it now.

### Step 5. Convert the type of the column Year to datetime64

```{python jupyter={'outputs_hidden': False}}
crime['dt_Year'] = pd.to_datetime(crime['Year'], format = '%Y')
```

```{python}
crime.head()
```

### Step 6. Set the Year column as the index of the dataframe

```{python jupyter={'outputs_hidden': False}}
crime.set_index('dt_Year')
```

### Step 7. Delete the Total column

```{python jupyter={'outputs_hidden': False}}
del crime['Total']
```

```{python}
crime.head()
```

### Step 8. Group the year by decades and sum the values

#### Pay attention to the Population column number, summing this column is a mistake

```{python jupyter={'outputs_hidden': False}}
crime['Decade'] = (crime['Year'] // 10) * 10
```

```{python}
crime.columns
```

```{python}
gb = crime.groupby('Decade')[['Violent', 'Property', 'Murder', 'Forcible_Rape',
       'Robbery', 'Aggravated_assault', 'Burglary', 'Larceny_Theft',
       'Vehicle_Theft']].sum()
```

```{python}
gb['Population'] = crime.groupby('Decade')['Population'].mean()
```

```{python}
gb
```

### Step 9. What is the most dangerous decade to live in the US?

```{python jupyter={'outputs_hidden': False}}
gb = gb.set_index('Decade')
```

```{python}
gb['Total'] = gb.loc[:, 'Violent': 'Vehicle_Theft'].sum(axis = 1)
```

```{python}
gb
```

```{python}
gb['Total'] / gb['Population']
```

```{python}
gb.idxmax()
```

```{python}
gb.iplot()
```

```{python}

```
